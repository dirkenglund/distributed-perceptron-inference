<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>gaussian filter phase analysis</title>
    <script type="module" crossorigin src="./assets/index-DFrkvKWf.js"></script>
    <link rel="modulepreload" crossorigin href="./assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin href="./assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin href="./assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin href="./assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin href="./assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin href="./assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin href="./assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin href="./assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin href="./assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin href="./assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin href="./assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin href="./assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin href="./assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin href="./assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin href="./assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin href="./assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin href="./assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin href="./assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin href="./assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin href="./assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin href="./assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin href="./assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin href="./assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin href="./assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin href="./assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin href="./assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin href="./assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin href="./assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin href="./assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin href="./assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin href="./assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin href="./assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin href="./assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin href="./assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin href="./assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin href="./assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin href="./assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin href="./assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin href="./assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin href="./assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin href="./assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin href="./assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin href="./assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin href="./assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin href="./assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-Dcqqg9UU.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-sMh6mJ2d.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-Btv5Rh1v.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-bBwmhqty.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CoCQUAeM.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin href="./assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin href="./assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin href="./assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin href="./assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin href="./assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin href="./assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin href="./assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin href="./assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin href="./assets/cells-DPp5cDaO.js">
    <link rel="modulepreload" crossorigin href="./assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin href="./assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin href="./assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin href="./assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin href="./assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin href="./assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin href="./assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin href="./assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin href="./assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin href="./assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin href="./assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin href="./assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin href="./assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin href="./assets/textarea-CRI7xDBj.js">
    <link rel="modulepreload" crossorigin href="./assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin href="./assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin href="./assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin href="./assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin href="./assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin href="./assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin href="./assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin href="./assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin href="./assets/switch-dWLWbbtg.js">
    <link rel="modulepreload" crossorigin href="./assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin href="./assets/mode-Bn7pdJvO.js">
    <link rel="modulepreload" crossorigin href="./assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin href="./assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin href="./assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin href="./assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin href="./assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin href="./assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin href="./assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin href="./assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin href="./assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin href="./assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin href="./assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin href="./assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin href="./assets/ai-model-dropdown-Dk2SdB3C.js">
    <link rel="modulepreload" crossorigin href="./assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin href="./assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin href="./assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin href="./assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin href="./assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin href="./assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin href="./assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin href="./assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin href="./assets/cell-link-B9b7J8QK.js">
    <link rel="modulepreload" crossorigin href="./assets/datasource-CtyqtITR.js">
    <link rel="modulepreload" crossorigin href="./assets/state-D4T75eZb.js">
    <link rel="modulepreload" crossorigin href="./assets/MarimoErrorOutput-Lf9P8Fhl.js">
    <link rel="modulepreload" crossorigin href="./assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin href="./assets/html-to-image-CIQqSu-S.js">
    <link rel="modulepreload" crossorigin href="./assets/focus-C1YokgL7.js">
    <link rel="modulepreload" crossorigin href="./assets/LazyAnyLanguageCodeMirror-DgZ8iknE.js">
    <link rel="modulepreload" crossorigin href="./assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin href="./assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin href="./assets/markdown-renderer-DJy8ww5d.js">
    <link rel="modulepreload" crossorigin href="./assets/command-2ElA5IkO.js">
    <link rel="modulepreload" crossorigin href="./assets/download-os8QlW6l.js">
    <link rel="modulepreload" crossorigin href="./assets/useRunCells-D2HBb4DB.js">
    <link rel="modulepreload" crossorigin href="./assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin href="./assets/RenderHTML-D-of_-s7.js">
    <link rel="modulepreload" crossorigin href="./assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin href="./assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin href="./assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin href="./assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin href="./assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin href="./assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin href="./assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin href="./assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin href="./assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin href="./assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin href="./assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin href="./assets/JsonOutput-PE5ko4gi.js">
    <link rel="modulepreload" crossorigin href="./assets/useDeleteCell-DdRX94yC.js">
    <link rel="modulepreload" crossorigin href="./assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin href="./assets/process-output-ByfLnk6j.js">
    <link rel="modulepreload" crossorigin href="./assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin href="./assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin href="./assets/esm-Bmu2DhPy.js">
    <link rel="modulepreload" crossorigin href="./assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin href="./assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin href="./assets/add-cell-with-ai-e_HMl7UU.js">
    <link rel="modulepreload" crossorigin href="./assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin href="./assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin href="./assets/chat-display--jAB7huF.js">
    <link rel="modulepreload" crossorigin href="./assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin href="./assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin href="./assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin href="./assets/column-preview-CXjSXUhP.js">
    <link rel="modulepreload" crossorigin href="./assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin href="./assets/globals-BgACvYmr.js">
    <link rel="modulepreload" crossorigin href="./assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin href="./assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin href="./assets/utilities.esm-MA1QpjVT.js">
    <link rel="modulepreload" crossorigin href="./assets/floating-outline-BtdqbkUq.js">
    <link rel="modulepreload" crossorigin href="./assets/useAddCell-CmuX2hOk.js">
    <link rel="modulepreload" crossorigin href="./assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin href="./assets/readonly-python-code-WjTf6Pdd.js">
    <link rel="modulepreload" crossorigin href="./assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin href="./assets/types-BRfQN3HL.js">
    <link rel="modulepreload" crossorigin href="./assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin href="./assets/form-BidPUZUn.js">
    <link rel="modulepreload" crossorigin href="./assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin href="./assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin href="./assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin href="./assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin href="./assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin href="./assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin href="./assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin href="./assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin href="./assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin href="./assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin href="./assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin href="./assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin href="./assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin href="./assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin href="./assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin href="./assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin href="./assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin href="./assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin href="./assets/index-CeUwN_0i.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="">%22%22%22%0ADistributed%20Perceptron%20Inference%3A%20Classical%20vs%20Quantum%20Sensor%20Networks%0A%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%0APOWER%20GRID%20ANOMALY%20DETECTION%20SCENARIO%0A-------------------------------------%0A-%20N%20%3D%2010s%20to%20100s%20of%20NV%20magnetometer%20sensors%20across%20power%20grid%0A-%20Each%20sensor%20monitors%2060%20Hz%20phase%20continuously%0A-%20Local%20trigger%3A%20%22Fire%22%20if%20phase%20deviation%20%3E%201%20mrad%20over%2010%20cycles%0A-%20Global%20inference%3A%20Aggregate%20sensor%20firings%20to%20detect%20grid%20anomalies%0A%0ATHE%20PERCEPTION%20PROBLEM%3A%0A-%20Process%20many%20time%20series%20(some%20sub-threshold)%20across%20N%20sensors%0A-%20Detect%20anomalies%20(faults%2C%20arcing%2C%20equipment%20failure)%20via%20distributed%20inference%0A-%20Analogous%20to%20neurons%20firing%20in%20a%20neural%20network%0A%0AQUANTUM%20ADVANTAGE%3A%20COHERENT%20MULTI-SENSOR%20FUSION%0A-%20Classical%3A%20Each%20sensor%20decides%20independently%20%E2%86%92%20aggregate%20votes%0A-%20Quantum%3A%20Coherently%20combine%20N%20sensors%20BEFORE%20thresholding%0A%20%20-%20SNR_coherent%20%3D%20N%C2%B2%20%C3%97%20SNR_single%20(Heisenberg%20limit!)%0A%20%20-%20Sub-threshold%20signals%20become%20detectable%20via%20coherent%20addition%0A%20%20-%20Faster%20decision%20time%20via%20Heisenberg-limited%20phase%20estimation%0A%0ABased%20on%3A%0A-%20Wu%2C%20Ma%2C%20Vadlamani%2C%20Choi%2C%20Englund%20-%20arXiv%3A2504.16119%20(MiRP)%0A-%20Quantum%20Computing%20Enhanced%20Sensing%20-%20arXiv%3A2501.07625v1%20(QSS)%0A%22%22%22%0A%0Aimport%20marimo%0A%0A__generated_with%20%3D%20%220.19.8%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20from%20dataclasses%20import%20dataclass%0A%20%20%20%20import%20sympy%20as%20sp%0A%20%20%20%20from%20typing%20import%20Any%2C%20Optional%0A%0A%0A%20%20%20%20return%20Any%2C%20dataclass%2C%20mo%2C%20np%2C%20plt%2C%20sp%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Distributed%20Perceptron%20Inference%3A%20Quantum%20Sensor%20Networks%0A%0A%20%20%20%20%23%23%20Problem%20Setup%0A%0A%20%20%20%20We%20formalize%20the%20distributed%20sensing%20problem%20using%20the%20following%20mathematical%20framework.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Any%2C%20dataclass%2C%20sp)%3A%0A%0A%20%20%20%20%40dataclass%0A%20%20%20%20class%20MathObject%3A%0A%20%20%20%20%20%20%20%20%22%22%22Mathematical%20object%20with%20dual%20representations%20for%20computation%20and%20display.%22%22%22%0A%20%20%20%20%20%20%20%20name%3A%20str%0A%20%20%20%20%20%20%20%20sympy_expr%3A%20Any%20%20%23%20SymPy%20expression%20for%20symbolic%20computation%0A%20%20%20%20%20%20%20%20latex%3A%20str%20%20%20%20%20%20%20%23%20LaTeX%20representation%20for%20typesetting%0A%20%20%20%20%20%20%20%20description%3A%20str%20%3D%20%22%22%0A%0A%20%20%20%20%20%20%20%20def%20_repr_latex_(self)%20-%3E%20str%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20f%22%24%24%7Bself.latex%7D%24%24%22%0A%0A%20%20%20%20%20%20%20%20def%20__str__(self)%20-%3E%20str%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.latex%0A%0A%20%20%20%20%23%20Define%20base%20symbols%0A%20%20%20%20N%20%3D%20sp.Symbol('N'%2C%20positive%3DTrue%2C%20integer%3DTrue)%0A%20%20%20%20phi_s%20%3D%20sp.Symbol('phi_s'%2C%20real%3DTrue)%0A%20%20%20%20theta%20%3D%20sp.Symbol('theta'%2C%20positive%3DTrue)%0A%20%20%20%20sigma%20%3D%20sp.Symbol('sigma'%2C%20positive%3DTrue)%0A%20%20%20%20i%20%3D%20sp.Symbol('i'%2C%20integer%3DTrue)%0A%20%20%20%20phi_i%20%3D%20sp.IndexedBase('phi')%0A%20%20%20%20n_i%20%3D%20sp.IndexedBase('n')%0A%0A%20%20%20%20%23%20Core%20MathObjects%0A%20%20%20%20N_sensors%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22N_sensors%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3DN%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22N%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Number%20of%20sensors%22%0A%20%20%20%20)%0A%0A%20%20%20%20signal_phase%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22signal_phase%22%2C%20%0A%20%20%20%20%20%20%20%20sympy_expr%3Dphi_s%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Cphi_s%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Common%20signal%20phase%22%0A%20%20%20%20)%0A%0A%20%20%20%20threshold%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22threshold%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dtheta%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Ctheta%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Detection%20threshold%22%0A%20%20%20%20)%0A%0A%20%20%20%20noise_std%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22noise_std%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsigma%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Csigma%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Noise%20standard%20deviation%20per%20sensor%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Measurement%20model%0A%20%20%20%20measurement_i%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22measurement_i%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsp.Eq(phi_i%5Bi%5D%2C%20phi_s%20%2B%20n_i%5Bi%5D)%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Cphi_i%20%3D%20%5Cphi_s%20%2B%20n_i%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Phase%20measurement%20at%20sensor%20i%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Estimators%0A%20%20%20%20avg_estimator%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22avg_estimator%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsp.Sum(phi_i%5Bi%5D%2C%20(i%2C%201%2C%20N))%20%2F%20N%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5CPhi_%7B%5Ctext%7Bavg%7D%7D%20%3D%20%5Cfrac%7B1%7D%7BN%7D%20%5Csum_%7Bi%3D1%7D%5E%7BN%7D%20%5Cphi_i%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Classical%20averaging%20estimator%22%0A%20%20%20%20)%0A%0A%20%20%20%20sum_estimator%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22sum_estimator%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsp.Sum(phi_i%5Bi%5D%2C%20(i%2C%201%2C%20N))%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5CPhi_%7B%5Ctext%7Bsum%7D%7D%20%3D%20%5Csum_%7Bi%3D1%7D%5E%7BN%7D%20%5Cphi_i%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Classical%20summation%20estimator%22%0A%20%20%20%20)%0A%0A%20%20%20%20quantum_estimator%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22quantum_estimator%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsp.Function('f_entangled')(*%5Bphi_i%5Bj%5D%20for%20j%20in%20range(1%2C%204)%5D)%2C%20%20%23%20symbolic%20placeholder%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5CPhi_%7B%5Ctext%7Bquantum%7D%7D%20%3D%20f_%7B%5Ctext%7Bentangled%7D%7D(%5Cphi_1%2C%20%5Cldots%2C%20%5Cphi_N)%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Quantum%20coherent%20estimator%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20SNR%20expressions%0A%20%20%20%20snr_single%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22snr_single%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsp.Abs(phi_s)%20%2F%20sigma%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Ctext%7BSNR%7D_%7B%5Ctext%7Bsingle%7D%7D%20%3D%20%7C%5Cphi_s%7C%20%2F%20%5Csigma%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Single%20sensor%20SNR%22%0A%20%20%20%20)%0A%0A%20%20%20%20snr_avg%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22snr_avg%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dsp.sqrt(N)%20*%20sp.Abs(phi_s)%20%2F%20sigma%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Ctext%7BSNR%7D_%7B%5Ctext%7Bavg%7D%7D%20%3D%20%5Csqrt%7BN%7D%20%5Ccdot%20%5Ctext%7BSNR%7D_%7B%5Ctext%7Bsingle%7D%7D%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Classical%20averaging%20SNR%20(SQL)%22%0A%20%20%20%20)%0A%0A%20%20%20%20snr_quantum%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22snr_quantum%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3DN%20*%20sp.Abs(phi_s)%20%2F%20sigma%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22%5Ctext%7BSNR%7D_%7B%5Ctext%7Bquantum%7D%7D%20%3D%20N%20%5Ccdot%20%5Ctext%7BSNR%7D_%7B%5Ctext%7Bsingle%7D%7D%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Quantum%20coherent%20SNR%20(Heisenberg)%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Resource%20scaling%0A%20%20%20%20N_classical_bound%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22N_classical_bound%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3D(theta%20%2F%20phi_s)**2%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22N_%7B%5Ctext%7Bclassical%7D%7D%20%5Cgeq%20(%5Ctheta%20%2F%20%5Cphi_s)%5E2%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Sensors%20required%20for%20classical%20detection%22%0A%20%20%20%20)%0A%0A%20%20%20%20N_quantum_bound%20%3D%20MathObject(%0A%20%20%20%20%20%20%20%20name%3D%22N_quantum_bound%22%2C%0A%20%20%20%20%20%20%20%20sympy_expr%3Dtheta%20%2F%20phi_s%2C%0A%20%20%20%20%20%20%20%20latex%3Dr%22N_%7B%5Ctext%7Bquantum%7D%7D%20%5Cgeq%20%5Ctheta%20%2F%20%5Cphi_s%22%2C%0A%20%20%20%20%20%20%20%20description%3D%22Sensors%20required%20for%20quantum%20detection%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%20Part%201%3A%20Classical%20Inference%20(Single%20Sensor)%0A%0A%20%20%20%20%23%23%20Signal%20Model%0A%0A%20%20%20%20A%20single%20NV-center%20sensor%20measures%3A%0A%20%20%20%20%24%24s(t)%20%3D%20%5Cgamma_%7BNV%7D%20%5Cint_0%5ET%20B(t')%20dt'%20%2B%20n(t)%20%3D%20%5Cphi_%7Bsignal%7D%20%2B%20n(t)%24%24%0A%0A%20%20%20%20where%3A%0A%20%20%20%20-%20%24%5Cgamma_%7BNV%7D%20%3D%202%5Cpi%20%5Ctimes%2028%24%20GHz%2FT%20(NV%20gyromagnetic%20ratio)%0A%20%20%20%20-%20%24B(t)%20%3D%20B_0%20%5Ccos(%5Comega%20t%20%2B%20%5Cphi_0)%24%20is%20the%20magnetic%20field%0A%20%20%20%20-%20%24n(t)%24%20is%20measurement%20noise%20(shot%20noise%2C%20thermal%2C%20etc.)%0A%20%20%20%20-%20%24%5Cphi_%7Bsignal%7D%20%3D%20%5Cgamma_%7BNV%7D%20B_0%20T%24%20is%20the%20accumulated%20phase%0A%0A%20%20%20%20%23%23%20Inference%20via%20Matched%20Filtering%20(Gabor%20Filter)%0A%0A%20%20%20%20To%20detect%20a%2060%20Hz%20signal%2C%20apply%20a%20**Gabor%20filter**%20(Gaussian-windowed%20sinusoid)%3A%0A%0A%20%20%20%20%24%24g(t)%20%3D%20e%5E%7B-%5Cfrac%7Bt%5E2%7D%7B2%5Csigma%5E2%7D%7D%20%5Ccos(2%5Cpi%20f_0%20t)%24%24%0A%0A%20%20%20%20The%20filter%20output%3A%0A%20%20%20%20%24%24y%20%3D%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20s(t)%20%5Ccdot%20g(t)%20dt%24%24%0A%0A%20%20%20%20**Decision%20rule**%3A%20If%20%24%7Cy%7C%20%3E%20%5Ctheta%24%2C%20declare%20signal%20present.%0A%0A%20%20%20%20%23%23%23%20Cram%C3%A9r-Rao%20Bound%20on%20Phase%20Estimation%0A%0A%20%20%20%20%24%24%5Csigma_%5Cphi%20%5Cgeq%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%20%5Ccdot%20%5Ctext%7BSNR%7D%20%5Ccdot%20N_%7Beff%7D%7D%7D%24%24%0A%0A%20%20%20%20For%20target%20%24%5Csigma_%5Cphi%20%3C%2010%5E%7B-3%7D%24%20rad%20with%20%24N_%7Beff%7D%20%3D%205%24%20cycles%3A%0A%20%20%20%20%24%24%5Ctext%7BSNR%7D%20%5Cgeq%20%5Cfrac%7B1%7D%7B2%20%5Ctimes%20(10%5E%7B-3%7D)%5E2%20%5Ctimes%205%7D%20%3D%2010%5E5%20%5Capprox%2050%20%5Ctext%7B%20dB%7D%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(dataclass%2C%20np)%3A%0A%20%20%20%20%40dataclass%0A%20%20%20%20class%20InferenceParameters%3A%0A%20%20%20%20%20%20%20%20%22%22%22Parameters%20for%20distributed%20perceptron%20inference%20on%20power%20grid%0A%0A%20%20%20%20%20%20%20%20THE%20PERCEPTION%20PROBLEM%3A%0A%20%20%20%20%20%20%20%20-%20N%20sensors%20distributed%20across%20power%20grid%0A%20%20%20%20%20%20%20%20-%20Each%20sensor%20%22fires%22%20if%20phase%20%3E%20threshold%20over%20M%20cycles%0A%20%20%20%20%20%20%20%20-%20Global%20inference%3A%20detect%20anomalies%20from%20aggregate%20firings%0A%0A%20%20%20%20%20%20%20%20NOISE%20MODEL%3A%0A%20%20%20%20%20%20%20%20Total%20noise%20variance%20%3D%20quantum%20noise%20%2B%20technical%20noise%20(add%20in%20quadrature)%0A%20%20%20%20%20%20%20%20%CF%83%C2%B2_total%20%3D%20%CF%83%C2%B2_quantum%20%2B%20%CF%83%C2%B2_readout%0A%0A%20%20%20%20%20%20%20%20-%20%CF%83_quantum%3A%20Fundamental%20shot%20noise%20from%20spin%20projection%20%2F%20photon%20statistics%0A%20%20%20%20%20%20%20%20-%20%CF%83_readout%3A%20Technical%20noise%20from%20sampling%20(ADC%2C%20amplifiers%2C%20thermal)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%23%20Signal%20parameters%20(power%20grid%20realistic)%0A%20%20%20%20%20%20%20%20f_signal%3A%20float%20%3D%2060.0%20%20%23%20Hz%20-%20fundamental%20power%20frequency%0A%20%20%20%20%20%20%20%20B_typical%3A%20float%20%3D%2010e-6%20%20%23%20T%20-%20typical%20field%20under%20transmission%20line%20(10%20%C2%B5T)%0A%20%20%20%20%20%20%20%20B_min%3A%20float%20%3D%201e-12%20%20%23%20T%20-%20NV%20sensitivity%20floor%20(1%20pT)%0A%0A%20%20%20%20%20%20%20%20%23%20Perceptron%20parameters%0A%20%20%20%20%20%20%20%20threshold_rad%3A%20float%20%3D%201e-3%20%20%23%20rad%20-%20firing%20threshold%20(1%20mrad)%0A%20%20%20%20%20%20%20%20integration_cycles%3A%20int%20%3D%2010%20%20%23%20Number%20of%2060%20Hz%20cycles%20to%20integrate%0A%0A%20%20%20%20%20%20%20%20%23%20Distributed%20sensor%20network%0A%20%20%20%20%20%20%20%20n_sensors%3A%20int%20%3D%20100%20%20%23%20Number%20of%20sensors%20across%20grid%0A%0A%20%20%20%20%20%20%20%20%23%20Anomaly%20signal%20(sub-threshold%20at%20individual%20sensors)%0A%20%20%20%20%20%20%20%20anomaly_phase%3A%20float%20%3D%200.5e-3%20%20%23%20rad%20-%200.5%20mrad%20(below%201%20mrad%20threshold!)%0A%0A%20%20%20%20%20%20%20%20%23%20NOISE%20CONTRIBUTIONS%20(both%20add%20in%20quadrature!)%0A%20%20%20%20%20%20%20%20%23%20Quantum%20shot%20noise%20(fundamental%20limit%20from%20measurement%20back-action)%0A%20%20%20%20%20%20%20%20sigma_quantum%3A%20float%20%3D%200.2e-3%20%20%23%20rad%20-%20quantum%20projection%20noise%20per%20sensor%0A%20%20%20%20%20%20%20%20%23%20Technical%2Freadout%20noise%20(ADC%20quantization%2C%20amplifier%20noise%2C%20thermal)%0A%20%20%20%20%20%20%20%20sigma_readout%3A%20float%20%3D%200.25e-3%20%20%23%20rad%20-%20readout%20chain%20noise%20per%20sensor%0A%0A%20%20%20%20%20%20%20%20%23%20Physical%20constants%0A%20%20%20%20%20%20%20%20gamma_nv%3A%20float%20%3D%202%20*%20np.pi%20*%2028e9%20%20%23%20rad%2Fs%2FT%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20period(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201.0%20%2F%20self.f_signal%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20integration_time(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Integration%20window%20%3D%20M%20cycles%20at%2060%20Hz%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.integration_cycles%20%2F%20self.f_signal%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20sigma_total(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Total%20noise%20per%20sensor%3A%20%CF%83%C2%B2_total%20%3D%20%CF%83%C2%B2_quantum%20%2B%20%CF%83%C2%B2_readout%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Independent%20noise%20sources%20add%20in%20quadrature%20(variances%20add).%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.sqrt(self.sigma_quantum**2%20%2B%20self.sigma_readout**2)%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20quantum_limited_fraction(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22What%20fraction%20of%20total%20variance%20is%20quantum%20(fundamental)%3F%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20If%20close%20to%201%3A%20sensor%20is%20quantum-limited%20(best%20case%20for%20Heisenberg)%0A%20%20%20%20%20%20%20%20%20%20%20%20If%20close%20to%200%3A%20technical%20noise%20dominates%20(limits%20quantum%20advantage)%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.sigma_quantum**2%20%2F%20(self.sigma_quantum**2%20%2B%20self.sigma_readout**2)%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20snr_linear(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22SNR%20%3D%20B_typical%20%2F%20B_min%20(power%20grid%20is%20HIGH%20SNR!)%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.B_typical%20%2F%20self.B_min%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20snr_db(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22SNR%20in%20dB%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%2010%20*%20np.log10(self.snr_linear)%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20snr_single_sensor(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22SNR%20for%20single%20sensor%3A%20signal%20%2F%20total_noise%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.anomaly_phase%20%2F%20self.sigma_total%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20signal_to_threshold_ratio(self)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22How%20much%20of%20threshold%20does%20anomaly%20signal%20reach%3F%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.anomaly_phase%20%2F%20self.threshold_rad%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20sensors_needed_sql(self)%20-%3E%20int%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Sensors%20needed%20for%20classical%20averaging%20to%20detect%20sub-threshold%20signal%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Classical%20averaging%3A%20%CF%83_avg%20%3D%20%CF%83_total%20%2F%20%E2%88%9AN%0A%20%20%20%20%20%20%20%20%20%20%20%20Need%20signal%20%3E%20threshold%2C%20i.e.%2C%20N%20%C3%97%20(signal%2F%CF%83_total)%C2%B2%20%3E%20(threshold%2F%CF%83_total)%C2%B2%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20ratio%20%3D%20self.threshold_rad%20%2F%20self.anomaly_phase%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20int(np.ceil(ratio**2))%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20sensors_needed_heisenberg(self)%20-%3E%20int%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Sensors%20needed%20for%20quantum%20coherent%20detection%20(with%20entanglement)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Note%3A%20True%20Heisenberg%20scaling%20only%20applies%20to%20QUANTUM%20noise!%0A%20%20%20%20%20%20%20%20%20%20%20%20Technical%20noise%20doesn't%20benefit%20from%20entanglement.%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20int(np.ceil(self.threshold_rad%20%2F%20self.anomaly_phase))%0A%0A%20%20%20%20params%20%3D%20InferenceParameters()%0A%20%20%20%20return%20(params%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20np%2C%20params)%3A%0A%20%20%20%20%23%20Calculate%20key%20quantities%20for%20perceptron%20model%0A%20%20%20%20T_window%20%3D%20params.integration_cycles%20%2F%20params.f_signal%20%20%23%20Integration%20time%20in%20seconds%0A%0A%20%20%20%20%23%20Sub-threshold%20detection%0A%20%20%20%20can_classical_detect%20%3D%20params.anomaly_phase%20%3E%20params.threshold_rad%0A%20%20%20%20n_sensors_needed_sql%20%3D%20int(np.ceil((params.threshold_rad%20%2F%20params.anomaly_phase)**2))%0A%20%20%20%20n_sensors_needed_hl%20%3D%20int(np.ceil(params.threshold_rad%20%2F%20params.anomaly_phase))%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%20Distributed%20Perceptron%20Parameters%0A%0A%20%20%20%20%23%23%23%20Single%20Sensor%20(Local%20Perceptron)%0A%0A%20%20%20%20%7C%20Parameter%20%7C%20Symbol%20%7C%20Value%20%7C%20Notes%20%7C%0A%20%20%20%20%7C-----------%7C--------%7C-------%7C-------%7C%0A%20%20%20%20%7C%20Frequency%20%7C%20%24f_0%24%20%7C%20%7Bparams.f_signal%7D%20Hz%20%7C%20Power%20grid%20fundamental%20%7C%0A%20%20%20%20%7C%20Integration%20window%20%7C%20%24T%24%20%7C%20%7BT_window*1000%3A.0f%7D%20ms%20%7C%20%7Bparams.integration_cycles%7D%20cycles%20%7C%0A%20%20%20%20%7C%20Firing%20threshold%20%7C%20%24%5C%5Ctheta%24%20%7C%20%7Bparams.threshold_rad*1000%3A.1f%7D%20mrad%20%7C%20Local%20trigger%20level%20%7C%0A%0A%20%20%20%20%23%23%23%20Noise%20Model%3A%20Quantum%20%2B%20Technical%20(Add%20in%20Quadrature)%0A%0A%20%20%20%20**Total%20noise%20variance**%20%3D%20quantum%20%2B%20readout%3A%0A%20%20%20%20%24%24%5C%5Csigma%5E2_%7B%7Btotal%7D%7D%20%3D%20%5C%5Csigma%5E2_%7B%7Bquantum%7D%7D%20%2B%20%5C%5Csigma%5E2_%7B%7Breadout%7D%7D%24%24%0A%0A%20%20%20%20%7C%20Noise%20Source%20%7C%20Symbol%20%7C%20Value%20%7C%20Variance%20Contribution%20%7C%0A%20%20%20%20%7C--------------%7C--------%7C-------%7C----------------------%7C%0A%20%20%20%20%7C%20Quantum%20(shot%20noise)%20%7C%20%24%5C%5Csigma_%7B%7Bquantum%7D%7D%24%20%7C%20%7Bparams.sigma_quantum*1000%3A.2f%7D%20mrad%20%7C%20%7Bparams.sigma_quantum**2%20%2F%20params.sigma_total**2%20*%20100%3A.1f%7D%25%20%7C%0A%20%20%20%20%7C%20Technical%20(readout)%20%7C%20%24%5C%5Csigma_%7B%7Breadout%7D%7D%24%20%7C%20%7Bparams.sigma_readout*1000%3A.2f%7D%20mrad%20%7C%20%7Bparams.sigma_readout**2%20%2F%20params.sigma_total**2%20*%20100%3A.1f%7D%25%20%7C%0A%20%20%20%20%7C%20**Total**%20%7C%20%24%5C%5Csigma_%7B%7Btotal%7D%7D%24%20%7C%20**%7Bparams.sigma_total*1000%3A.2f%7D%20mrad**%20%7C%20100%25%20%7C%0A%0A%20%20%20%20**Quantum-limited%20fraction**%3A%20%7Bparams.quantum_limited_fraction%3A.1%25%7D%20(if%20%E2%89%88100%25%2C%20entanglement%20helps%20maximally)%0A%0A%20%20%20%20%23%23%23%20Sensor%20Network%0A%0A%20%20%20%20%7C%20Parameter%20%7C%20Value%20%7C%20Notes%20%7C%0A%20%20%20%20%7C-----------%7C-------%7C-------%7C%0A%20%20%20%20%7C%20Number%20of%20sensors%20%7C%20%24N%20%3D%20%7Bparams.n_sensors%7D%24%20%7C%20Distributed%20across%20grid%20%7C%0A%20%20%20%20%7C%20Anomaly%20signal%20%7C%20%24%5C%5Cphi_%7B%7Banomaly%7D%7D%20%3D%20%7Bparams.anomaly_phase*1000%3A.1f%7D%24%20mrad%20%7C%20**Below%20threshold!**%20%7C%0A%20%20%20%20%7C%20SNR%20per%20sensor%20%7C%20%24%5C%5Cphi%20%2F%20%5C%5Csigma_%7B%7Btotal%7D%7D%20%3D%20%7Bparams.snr_single_sensor%3A.2f%7D%24%20%7C%20Signal%2Fnoise%20ratio%20%7C%0A%0A%20%20%20%20%23%23%23%20Detection%20Analysis%0A%0A%20%20%20%20**Single%20sensor**%3A%20Anomaly%20is%20**%7B'DETECTABLE%20%E2%9C%93'%20if%20can_classical_detect%20else%20'NOT%20detectable%20%E2%9C%97'%7D**%20(signal%20%3C%20threshold)%0A%0A%20%20%20%20**Classical%20averaging%20(SQL)**%3A%20Need%20%24N%20%5C%5Cgeq%20%7Bn_sensors_needed_sql%7D%24%20sensors%20for%20SNR%20boost%20to%20reach%20threshold%0A%0A%20%20%20%20**Quantum%20coherent%20(Heisenberg)**%3A%20Need%20%24N%20%5C%5Cgeq%20%7Bn_sensors_needed_hl%7D%24%20sensors%20(with%20entanglement)%0A%0A%20%20%20%20**With%20%7Bparams.n_sensors%7D%20sensors**%3A%0A%20%20%20%20-%20Classical%20averaging%20gives%20%24%7Bnp.sqrt(params.n_sensors)%3A.1f%7D%5C%5Ctimes%24%20SNR%20boost%20%E2%86%92%20effective%20signal%20%3D%20%7Bparams.anomaly_phase%20*%20np.sqrt(params.n_sensors)%20*%201000%3A.2f%7D%20mrad%0A%20%20%20%20-%20Quantum%20coherent%20gives%20%24%7Bparams.n_sensors%7D%5C%5Ctimes%24%20SNR%20boost%20%E2%86%92%20effective%20signal%20%3D%20%7Bparams.anomaly_phase%20*%20params.n_sensors%20*%201000%3A.1f%7D%20mrad%20(requires%20entanglement)%0A%0A%20%20%20%20%23%23%23%20Critical%20Caveat%3A%20Technical%20Noise%20Limits%20Quantum%20Advantage!%0A%0A%20%20%20%20True%20Heisenberg%20scaling%20only%20applies%20to%20**quantum-limited**%20noise.%0A%20%20%20%20Technical%20noise%20(readout)%20does%20**NOT**%20benefit%20from%20entanglement!%0A%0A%20%20%20%20**Effective%20SNR%20improvement%20with%20entanglement**%3A%0A%20%20%20%20%24%24%5C%5Ctext%7B%7BSNR%7D%7D_%7B%7Bent%7D%7D%20%3D%20%5C%5Cfrac%7B%7BN%20%5C%5Ccdot%20%5C%5Cphi%7D%7D%7B%7B%5C%5Csqrt%7B%7BN%20%5C%5Ccdot%20%5C%5Csigma%5E2_%7B%7Bquantum%7D%7D%20%2B%20N%20%5C%5Ccdot%20%5C%5Csigma%5E2_%7B%7Breadout%7D%7D%7D%7D%7D%7D%20%3D%20%5C%5Cfrac%7B%7B%5C%5Csqrt%7B%7BN%7D%7D%20%5C%5Ccdot%20%5C%5Cphi%7D%7D%7B%7B%5C%5Csqrt%7B%7B%5C%5Csigma%5E2_%7B%7Bquantum%7D%7D%2FN%20%2B%20%5C%5Csigma%5E2_%7B%7Breadout%7D%7D%7D%7D%7D%7D%24%24%0A%0A%20%20%20%20When%20%24%5C%5Csigma_%7B%7Breadout%7D%7D%20%5C%5Cgg%20%5C%5Csigma_%7B%7Bquantum%7D%7D%2FN%24%2C%20technical%20noise%20dominates%20%E2%86%92%20back%20to%20SQL!%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%20Part%202%3A%20The%20Perceptron%20Firing%20Model%0A%0A%20%20%20%20%23%23%20Local%20Sensor%20as%20Perceptron%0A%0A%20%20%20%20Each%20NV%20magnetometer%20sensor%20acts%20as%20a%20**threshold%20detector**%20(perceptron)%3A%0A%0A%20%20%20%20%24%24%5Ctext%7Boutput%7D_i%20%3D%20%5Cbegin%7Bcases%7D%201%20%26%20%5Ctext%7Bif%20%7D%20%7C%5Cphi_i%7C%20%3E%20%5Ctheta%20%5C%5C%200%20%26%20%5Ctext%7Botherwise%7D%20%5Cend%7Bcases%7D%24%24%0A%0A%20%20%20%20where%3A%0A%20%20%20%20-%20%24%5Cphi_i%20%3D%20%5Cgamma_%7BNV%7D%20%5Cint_0%5E%7BMT%7D%20B_i(t')%20%5Ccos(%5Comega%20t')%20dt'%24%20is%20the%20accumulated%20phase%20at%20sensor%20%24i%24%0A%20%20%20%20-%20%24%5Ctheta%20%3D%2010%5E%7B-3%7D%24%20rad%20is%20the%20firing%20threshold%0A%20%20%20%20-%20%24M%20%3D%2010%24%20cycles%20at%2060%20Hz%20%E2%86%92%20%24T_%7Bwindow%7D%20%3D%20167%24%20ms%20integration%20window%0A%0A%20%20%20%20%23%23%23%20The%20Sub-Threshold%20Challenge%0A%0A%20%20%20%20**Problem**%3A%20A%20weak%20anomaly%20may%20produce%20phase%20%24%5Cphi_i%20%3C%20%5Ctheta%24%20at%20every%20individual%20sensor%2C%20yet%20the%20anomaly%20IS%20present.%0A%0A%20%20%20%20**Classical%20fusion%20(voting)**%3A%0A%20%20%20%20-%20If%20no%20sensor%20fires%2C%20anomaly%20goes%20undetected%0A%20%20%20%20-%20Detection%20requires%20signal%20%3E%20threshold%20somewhere%0A%0A%20%20%20%20**Quantum%20coherent%20fusion**%3A%0A%20%20%20%20-%20Combine%20all%20N%20sensor%20phases%20coherently%20BEFORE%20thresholding%0A%20%20%20%20-%20Total%20phase%3A%20%24%5CPhi%20%3D%20%5Csum_i%20%5Cphi_i%20%3D%20N%20%5Ccdot%20%5Cphi_%7Bavg%7D%24%0A%20%20%20%20-%20Even%20if%20%24%5Cphi_i%20%3C%20%5Ctheta%24%20for%20all%20%24i%24%2C%20we%20can%20have%20%24%5CPhi%20%3E%20N%5Ctheta%24%0A%0A%20%20%20%20%23%23%23%20Signal%20Model%0A%0A%20%20%20%20For%20a%20global%20anomaly%20affecting%20all%20sensors%20similarly%3A%0A%20%20%20%20%24%24%5Cphi_i%20%3D%20%5Cphi_%7Bsignal%7D%20%2B%20n_i%24%24%0A%0A%20%20%20%20where%20%24n_i%24%20is%20noise%20at%20sensor%20%24i%24%20with%20variance%20%24%5Csigma%5E2%24.%0A%0A%20%20%20%20**Classical%20(average%20then%20threshold)**%3A%0A%20%20%20%20%24%24%5Cbar%7B%5Cphi%7D%20%3D%20%5Cfrac%7B1%7D%7BN%7D%5Csum_i%20%5Cphi_i%20%3D%20%5Cphi_%7Bsignal%7D%20%2B%20%5Cfrac%7B1%7D%7BN%7D%5Csum_i%20n_i%24%24%0A%20%20%20%20%24%24%5Ctext%7BSNR%7D_%7Bavg%7D%20%3D%20%5Cfrac%7B%5Cphi_%7Bsignal%7D%7D%7B%5Csigma%2F%5Csqrt%7BN%7D%7D%20%3D%20%5Csqrt%7BN%7D%20%5Ccdot%20%5Ctext%7BSNR%7D_%7Bsingle%7D%24%24%0A%0A%20%20%20%20**Quantum%20(coherent%20addition)**%3A%0A%20%20%20%20%24%24%5CPhi%20%3D%20%5Csum_i%20%5Cphi_i%20%3D%20N%20%5Cphi_%7Bsignal%7D%20%2B%20%5Csum_i%20n_i%24%24%0A%20%20%20%20%24%24%5Ctext%7BSNR%7D_%7Bcoherent%7D%20%3D%20%5Cfrac%7BN%20%5Cphi_%7Bsignal%7D%7D%7B%5Csqrt%7BN%7D%5Csigma%7D%20%3D%20%5Csqrt%7BN%7D%20%5Ccdot%20N%5E%7B1%2F2%7D%20%5Ccdot%20%5Ctext%7BSNR%7D_%7Bsingle%7D%24%24%0A%0A%20%20%20%20Wait%E2%80%94that's%20still%20%24%5Csqrt%7BN%7D%24!%20The%20Heisenberg%20advantage%20requires%20**entanglement**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20classical_inference_error(snr_db)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Error%20probability%20for%20classical%20(single%20sensor)%20inference%22%22%22%0A%20%20%20%20%20%20%20%20snr_linear%20%3D%2010**(snr_db%20%2F%2010)%0A%20%20%20%20%20%20%20%20%23%20Complementary%20error%20function%20approximation%0A%20%20%20%20%20%20%20%20return%200.5%20*%20np.exp(-snr_linear%20%2F%204)%20%20%23%20Simplified%20for%20visualization%0A%0A%20%20%20%20def%20quantum_inference_error(snr_db%2C%20n_sensors)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Error%20probability%20with%20coherent%20n_S%20sensor%20addition%0A%0A%20%20%20%20%20%20%20%20Key%20insight%3A%20Coherent%20addition%20gives%20n_S%5E2%20improvement%20in%20SNR!%0A%20%20%20%20%20%20%20%20-%20n_S%20sensors%20each%20accumulate%20phase%20%E2%88%9D%20B%0A%20%20%20%20%20%20%20%20-%20Coherent%20readout%3A%20total%20phase%20%E2%88%9D%20n_S%20%C3%97%20B%0A%20%20%20%20%20%20%20%20-%20SNR%20%E2%88%9D%20(n_S%20%C3%97%20B)%5E2%20%2F%20noise%20%3D%20n_S%5E2%20%C3%97%20SNR_single%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20snr_single%20%3D%2010**(snr_db%20%2F%2010)%0A%20%20%20%20%20%20%20%20snr_coherent%20%3D%20n_sensors**2%20*%20snr_single%20%20%23%20Heisenberg-like%20scaling!%0A%20%20%20%20%20%20%20%20return%200.5%20*%20np.exp(-snr_coherent%20%2F%204)%0A%0A%20%20%20%20def%20mirp_inference_error(snr_db%2C%20ml_gain%3D3.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22MiRP%20ML-enhanced%20inference%20error%0A%0A%20%20%20%20%20%20%20%20ML%20provides%20~3x%20effective%20SNR%20gain%20through%3A%0A%20%20%20%20%20%20%20%20-%20Learned%20optimal%20features%0A%20%20%20%20%20%20%20%20-%20Sub-Nyquist%20sampling%20(less%20aliasing%20noise)%0A%20%20%20%20%20%20%20%20-%20Nonlinear%20mixing%20information%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20effective_snr%20%3D%2010**(snr_db%20%2F%2010)%20*%20ml_gain%0A%20%20%20%20%20%20%20%20return%200.5%20*%20np.exp(-effective_snr%20%2F%204)%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20classical_inference_error%2C%0A%20%20%20%20%20%20%20%20mirp_inference_error%2C%0A%20%20%20%20%20%20%20%20quantum_inference_error%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20classical_inference_error%2C%0A%20%20%20%20mirp_inference_error%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20np%2C%0A%20%20%20%20params%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20quantum_inference_error%2C%0A)%3A%0A%20%20%20%20%23%20Plot%20inference%20error%20vs%20SNR%20for%20all%20three%20approaches%0A%20%20%20%20snr_range%20%3D%20np.linspace(-10%2C%2030%2C%20200)%0A%0A%20%20%20%20classical_error%20%3D%20%5Bclassical_inference_error(s)%20for%20s%20in%20snr_range%5D%0A%20%20%20%20quantum_error%20%3D%20%5Bquantum_inference_error(s%2C%20params.n_sensors)%20for%20s%20in%20snr_range%5D%0A%20%20%20%20mirp_error%20%3D%20%5Bmirp_inference_error(s)%20for%20s%20in%20snr_range%5D%0A%0A%20%20%20%20fig1%2C%20ax1%20%3D%20plt.subplots(figsize%3D(12%2C%207))%0A%0A%20%20%20%20ax1.semilogy(snr_range%2C%20classical_error%2C%20'b-'%2C%20linewidth%3D2.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Classical%20(single%20sensor)')%0A%20%20%20%20ax1.semilogy(snr_range%2C%20mirp_error%2C%20'orange'%2C%20linewidth%3D2.5%2C%20linestyle%3D'--'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D'MiRP%20(ML-enhanced%2C%20~5%20dB%20gain)')%0A%20%20%20%20ax1.semilogy(snr_range%2C%20quantum_error%2C%20'r-'%2C%20linewidth%3D2.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Quantum%20(n_S%3D%7Bparams.n_sensors%7D%20coherent%20sensors)')%0A%0A%20%20%20%20%23%20Mark%20key%20regions%0A%20%20%20%20ax1.axhline(y%3D0.01%2C%20color%3D'gray'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.7%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D'1%25%20error%20threshold')%0A%20%20%20%20ax1.axhline(y%3D0.5%2C%20color%3D'gray'%2C%20linestyle%3D'-.'%2C%20alpha%3D0.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D'50%25%20(random%20guessing)')%0A%0A%20%20%20%20%23%20Find%20SNR%20needed%20for%201%25%20error%0A%20%20%20%20classical_snr_1pct%20%3D%20snr_range%5Bnp.argmin(np.abs(np.array(classical_error)%20-%200.01))%5D%0A%20%20%20%20quantum_snr_1pct%20%3D%20snr_range%5Bnp.argmin(np.abs(np.array(quantum_error)%20-%200.01))%5D%0A%20%20%20%20mirp_snr_1pct%20%3D%20snr_range%5Bnp.argmin(np.abs(np.array(mirp_error)%20-%200.01))%5D%0A%0A%20%20%20%20%23%20Annotate%0A%20%20%20%20ax1.annotate(f'Classical%3A%20%7Bclassical_snr_1pct%3A.0f%7D%20dB'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(classical_snr_1pct%2C%200.01)%2C%20xytext%3D(classical_snr_1pct-8%2C%200.05)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'blue'%2C%20lw%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D11%2C%20color%3D'blue'%2C%20weight%3D'bold')%0A%20%20%20%20ax1.annotate(f'MiRP%3A%20%7Bmirp_snr_1pct%3A.0f%7D%20dB'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(mirp_snr_1pct%2C%200.01)%2C%20xytext%3D(mirp_snr_1pct-8%2C%200.003)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'orange'%2C%20lw%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D11%2C%20color%3D'orange'%2C%20weight%3D'bold')%0A%20%20%20%20ax1.annotate(f'Quantum%3A%20%7Bquantum_snr_1pct%3A.0f%7D%20dB'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(quantum_snr_1pct%2C%200.01)%2C%20xytext%3D(quantum_snr_1pct%2B3%2C%200.05)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'red'%2C%20lw%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D11%2C%20color%3D'red'%2C%20weight%3D'bold')%0A%0A%20%20%20%20ax1.set_xlabel('Input%20SNR%20per%20sensor%20(dB)'%2C%20fontsize%3D13)%0A%20%20%20%20ax1.set_ylabel('Inference%20Error%20Probability'%2C%20fontsize%3D13)%0A%20%20%20%20ax1.set_title('Waveform%20Detection%3A%20Classical%20vs%20ML%20vs%20Quantum%20Sensing'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D15%2C%20weight%3D'bold')%0A%20%20%20%20ax1.set_xlim(-10%2C%2030)%0A%20%20%20%20ax1.set_ylim(1e-6%2C%201)%0A%20%20%20%20ax1.legend(loc%3D'upper%20right'%2C%20fontsize%3D11)%0A%20%20%20%20ax1.grid(True%2C%20alpha%3D0.3)%0A%0A%20%20%20%20%23%20Add%20shaded%20region%20showing%20quantum%20advantage%0A%20%20%20%20ax1.fill_between(snr_range%2C%20classical_error%2C%20quantum_error%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20where%3D%5Bc%20%3E%20q%20for%20c%2C%20q%20in%20zip(classical_error%2C%20quantum_error)%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alpha%3D0.15%2C%20color%3D'red'%2C%20label%3D'_nolegend_')%0A%0A%20%20%20%20plt.tight_layout()%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%20Inference%20Error%20Comparison%0A%0A%20%20%20%20**Key%20Result**%3A%20For%201%25%20inference%20error%3A%0A%20%20%20%20-%20Classical%20requires%3A%20**%7Bclassical_snr_1pct%3A.0f%7D%20dB**%20SNR%20per%20sensor%0A%20%20%20%20-%20MiRP%20requires%3A%20**%7Bmirp_snr_1pct%3A.0f%7D%20dB**%20SNR%20(~%7Bclassical_snr_1pct%20-%20mirp_snr_1pct%3A.0f%7D%20dB%20savings)%0A%20%20%20%20-%20Quantum%20requires%3A%20**%7Bquantum_snr_1pct%3A.0f%7D%20dB**%20SNR%20(**%7Bclassical_snr_1pct%20-%20quantum_snr_1pct%3A.0f%7D%20dB%20advantage!**)%0A%0A%20%20%20%20The%20quantum%20advantage%20comes%20from%20**coherent%20signal%20addition**%20across%20%24n_S%20%3D%20%7Bparams.n_sensors%7D%24%20sensors%3A%0A%20%20%20%20%24%24%5C%5Ctext%7B%7BSNR%7D%7D_%7B%7Bcoherent%7D%7D%20%3D%20n_S%5E2%20%5C%5Ctimes%20%5C%5Ctext%7B%7BSNR%7D%7D_%7B%7Bsingle%7D%7D%20%3D%20%7Bparams.n_sensors%7D%5E2%20%5C%5Ctimes%20%5C%5Ctext%7B%7BSNR%7D%7D_%7B%7Bsingle%7D%7D%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20fig1%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%20Part%203%3A%20Quantum-Enhanced%20Multi-Sensor%20Fusion%0A%0A%20%20%20%20%23%23%20Why%20Quantum%3F%20Sub-Threshold%20Signal%20Recovery%0A%0A%20%20%20%20**The%20power%20grid%20problem%20is%20NOT%20frequency%20search**%20(we%20know%20it's%2060%20Hz!).%0A%0A%20%20%20%20**The%20real%20problem**%3A%20Detect%20weak%20anomalies%20that%20are%20**below%20threshold%20at%20individual%20sensors**.%0A%0A%20%20%20%20%23%23%23%20Classical%20vs%20Quantum%20Sensor%20Fusion%0A%0A%20%20%20%20From%20the%20QSS%20paper%20(arXiv%3A2501.07625v1)%3A%0A%0A%20%20%20%20%3E%20%22The%20signal%20%24B_%7B%5Cmin%7D%20%5Ccos(%5Comega%20t%20%2B%20%5Cphi)%24%20simultaneously%20rotates%20each%20of%20the%20sensors%20by%20a%20%24Z%24-rotation%20%24e%5E%7B-iB_%7B%5Cmin%7DZ_i%20t%2F2%7D%24%2C%20which%20can%20be%20viewed%20as%20a%20many-body%20perturbation%20to%20the%20Ising%20model.%22%0A%0A%20%20%20%20**Classical%20(incoherent%20averaging)**%3A%0A%20%20%20%20-%20Each%20sensor%20measures%20independently%2C%20then%20average%0A%20%20%20%20-%20Noise%20averages%20as%20%24%5Csigma_%7Bavg%7D%20%3D%20%5Csigma%20%2F%20%5Csqrt%7BN%7D%24%0A%20%20%20%20-%20Signal%20stays%20at%20%24%5Cphi_%7Bsignal%7D%24%0A%20%20%20%20-%20SNR%20improves%20by%20%24%5Csqrt%7BN%7D%24%20%E2%86%92%20**Standard%20Quantum%20Limit%20(SQL)**%0A%0A%20%20%20%20**Quantum%20(entangled%2Fcoherent)**%3A%0A%20%20%20%20-%20Sensors%20are%20entangled%20(e.g.%2C%20GHZ%20state)%20or%20coherently%20coupled%0A%20%20%20%20-%20Signal%20phases%20add%20coherently%3A%20%24%5Cphi_%7Btotal%7D%20%3D%20N%20%5Ctimes%20%5Cphi_%7Bsingle%7D%24%0A%20%20%20%20-%20Noise%20adds%20in%20quadrature%3A%20%24%5Csigma_%7Btotal%7D%20%3D%20%5Csqrt%7BN%7D%20%5Ctimes%20%5Csigma_%7Bsingle%7D%24%0A%20%20%20%20-%20SNR%20improves%20by%20%24N%24%20%E2%86%92%20**Heisenberg%20Limit!**%0A%0A%20%20%20%20%23%23%23%20The%20Hamiltonian%0A%0A%20%20%20%20The%20coupled%20sensor%20system%20with%20AC%20field%3A%0A%0A%20%20%20%20%24%24H_%7BAC%7D(t)%20%3D%20B_%7B%5Cmin%7D%20%5Ccos(%5Comega%20t%20%2B%20%5Cphi)%20%5Csum_%7Bi%3D1%7D%5E%7Bn_S%7D%20Z_i%24%24%0A%0A%20%20%20%20The%20coherent%20sum%20%24%5Csum_i%20Z_i%24%20provides%20the%20%24n_S%24-fold%20phase%20enhancement!%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Entanglement%3A%20The%20Key%20to%20Heisenberg%20Scaling%0A%0A%20%20%20%20%23%23%23%20Why%20Simple%20Coherent%20Addition%20Is%20NOT%20Enough%0A%0A%20%20%20%20**Important%20caveat**%3A%20Just%20adding%20sensor%20outputs%20coherently%20(without%20entanglement)%20still%20gives%20SQL!%0A%0A%20%20%20%20%24%24%5CPhi_%7Bclassical%7D%20%3D%20%5Csum_i%20%5Cphi_i%20%3D%20N%20%5Cphi_%7Bsignal%7D%20%2B%20%5Csum_i%20n_i%24%24%0A%0A%20%20%20%20The%20noise%20term%20%24%5Csum_i%20n_i%24%20has%20standard%20deviation%20%24%5Csqrt%7BN%7D%20%5Csigma%24%2C%20so%3A%0A%0A%20%20%20%20%24%24%5Ctext%7BSNR%7D_%7Bclassical%7D%20%3D%20%5Cfrac%7BN%20%5Cphi_%7Bsignal%7D%7D%7B%5Csqrt%7BN%7D%20%5Csigma%7D%20%3D%20%5Csqrt%7BN%7D%20%5Ccdot%20%5Ctext%7BSNR%7D_%7Bsingle%7D%24%24%0A%0A%20%20%20%20This%20is%20still%20SQL!%20Where's%20the%20Heisenberg%20advantage%3F%0A%0A%20%20%20%20%23%23%23%20Entanglement%20Enables%20Heisenberg%0A%0A%20%20%20%20With%20**entangled%20sensors**%20(e.g.%2C%20GHZ%20state%20%24%7CGHZ%5Crangle%20%3D%20(%7C00...0%5Crangle%20%2B%20%7C11...1%5Crangle)%2F%5Csqrt%7B2%7D%24)%3A%0A%0A%20%20%20%201.%20The%20collective%20state%20acquires%20phase%20%24e%5E%7Bi%20N%20%5Cphi%7D%24%20(not%20%24e%5E%7Bi%5Cphi%7D%24%20per%20sensor)%0A%20%20%20%202.%20This%20is%20a%20**single%20quantum%20phase**%20of%20size%20%24N%5Cphi%24%0A%20%20%20%203.%20Quantum%20projection%20noise%20scales%20as%20%24%5Csqrt%7BN%7D%24%20(same%20as%20classical)%0A%20%20%20%204.%20But%20signal%20is%20%24N%5Ctimes%24%20larger%20%E2%86%92%20SNR%20scales%20as%20%24N%24!%0A%0A%20%20%20%20%24%24%5Ctext%7BSNR%7D_%7BHeisenberg%7D%20%3D%20%5Cfrac%7BN%20%5Cphi_%7Bsignal%7D%7D%7B%5Csigma%7D%20%3D%20N%20%5Ccdot%20%5Ctext%7BSNR%7D_%7Bsingle%7D%24%24%0A%0A%20%20%20%20%23%23%23%20Requirements%20for%20Heisenberg%20Scaling%0A%0A%20%20%20%20%7C%20Requirement%20%7C%20Classical%20%7C%20Quantum%20%7C%0A%20%20%20%20%7C-------------%7C-----------%7C---------%7C%0A%20%20%20%20%7C%20Entanglement%20%7C%20%E2%9C%97%20Not%20needed%20%7C%20%E2%9C%93%20Required%20%7C%0A%20%20%20%20%7C%20Coherence%20time%20%7C%20%E2%9C%97%20Per%20sensor%20%7C%20%E2%9C%93%20Global%20%7C%0A%20%20%20%20%7C%20Readout%20%7C%20Independent%20%7C%20Collective%20%7C%0A%20%20%20%20%7C%20Hardware%20%7C%20Simple%20%7C%20Complex%20%7C%0A%0A%20%20%20%20**Bottom%20line**%3A%20True%20Heisenberg%20scaling%20requires%20**quantum%20entanglement**%20or%20**squeezed%20states**%2C%20not%20just%20classical%20averaging.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20params)%3A%0A%20%20%20%20def%20detection_time_classical(n_sensors%2C%20threshold_rad%2C%20noise_std)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Time%20to%20reach%20threshold%20with%20classical%20averaging%20(SQL)%0A%0A%20%20%20%20%20%20%20%20Classical%20averaging%3A%20SNR%20improves%20by%20sqrt(N)%0A%20%20%20%20%20%20%20%20Need%20SNR%20%3E%3D%20threshold%20%2F%20noise%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20snr_single%20%3D%20threshold_rad%20%2F%20noise_std%0A%20%20%20%20%20%20%20%20%23%20Number%20of%20sensors%20needed%20to%20reach%20threshold%0A%20%20%20%20%20%20%20%20n_needed%20%3D%20(threshold_rad%20%2F%20noise_std)%20**%202%0A%20%20%20%20%20%20%20%20%23%20Time%20per%20measurement%20(integration%20time)%0A%20%20%20%20%20%20%20%20T_int%20%3D%20params.integration_cycles%20%2F%20params.f_signal%0A%20%20%20%20%20%20%20%20%23%20Number%20of%20measurement%20rounds%20needed%0A%20%20%20%20%20%20%20%20n_rounds%20%3D%20int(np.ceil(n_needed%20%2F%20n_sensors))%0A%20%20%20%20%20%20%20%20return%20n_rounds%20*%20T_int%0A%0A%20%20%20%20def%20detection_time_quantum(n_sensors%2C%20threshold_rad%2C%20noise_std)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Time%20to%20reach%20threshold%20with%20Heisenberg%20scaling%0A%0A%20%20%20%20%20%20%20%20Quantum%20coherent%3A%20SNR%20improves%20by%20N%20(with%20entanglement)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20snr_single%20%3D%20threshold_rad%20%2F%20noise_std%0A%20%20%20%20%20%20%20%20%23%20Number%20of%20sensors%20needed%20to%20reach%20threshold%20(linear%2C%20not%20quadratic)%0A%20%20%20%20%20%20%20%20n_needed%20%3D%20threshold_rad%20%2F%20noise_std%0A%20%20%20%20%20%20%20%20%23%20Time%20per%20measurement%0A%20%20%20%20%20%20%20%20T_int%20%3D%20params.integration_cycles%20%2F%20params.f_signal%0A%20%20%20%20%20%20%20%20%23%20Number%20of%20measurement%20rounds%20needed%0A%20%20%20%20%20%20%20%20n_rounds%20%3D%20max(1%2C%20int(np.ceil(n_needed%20%2F%20n_sensors)))%0A%20%20%20%20%20%20%20%20return%20n_rounds%20*%20T_int%0A%0A%20%20%20%20def%20snr_improvement_sql(n_sensors)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Classical%20averaging%20SNR%20improvement%22%22%22%0A%20%20%20%20%20%20%20%20return%20np.sqrt(n_sensors)%0A%0A%20%20%20%20def%20snr_improvement_heisenberg(n_sensors)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Quantum%20coherent%20SNR%20improvement%20(with%20entanglement)%22%22%22%0A%20%20%20%20%20%20%20%20return%20n_sensors%0A%0A%20%20%20%20return%20snr_improvement_heisenberg%2C%20snr_improvement_sql%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20np%2C%20params%2C%20plt%2C%20snr_improvement_heisenberg%2C%20snr_improvement_sql)%3A%0A%20%20%20%20%23%20Plot%20SNR%20improvement%20vs%20number%20of%20sensors%0A%20%20%20%20n_sensors_range%20%3D%20np.arange(1%2C%20201)%0A%0A%20%20%20%20snr_sql%20%3D%20%5Bsnr_improvement_sql(n)%20for%20n%20in%20n_sensors_range%5D%0A%20%20%20%20snr_hl%20%3D%20%5Bsnr_improvement_heisenberg(n)%20for%20n%20in%20n_sensors_range%5D%0A%0A%20%20%20%20fig2%2C%20(ax2a%2C%20ax2b)%20%3D%20plt.subplots(1%2C%202%2C%20figsize%3D(14%2C%206))%0A%0A%20%20%20%20%23%20Left%3A%20SNR%20improvement%0A%20%20%20%20ax2a.plot(n_sensors_range%2C%20snr_sql%2C%20'b-'%2C%20linewidth%3D2.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr'Classical%3A%20%24%5Csqrt%7BN%7D%24%20(SQL)')%0A%20%20%20%20ax2a.plot(n_sensors_range%2C%20snr_hl%2C%20'r-'%2C%20linewidth%3D2.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr'Quantum%3A%20%24N%24%20(Heisenberg)')%0A%20%20%20%20ax2a.axhline(y%3D1%2Fparams.signal_to_threshold_ratio%2C%20color%3D'k'%2C%20linestyle%3D'--'%2C%20alpha%3D0.7%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Detection%20threshold%20(%7B1%2Fparams.signal_to_threshold_ratio%3A.0f%7D%C3%97%20needed)')%0A%20%20%20%20ax2a.set_xlabel('Number%20of%20Sensors%20(N)'%2C%20fontsize%3D13)%0A%20%20%20%20ax2a.set_ylabel('SNR%20Improvement%20Factor'%2C%20fontsize%3D13)%0A%20%20%20%20ax2a.set_title('Distributed%20Sensor%20Fusion%3A%20SQL%20vs%20Heisenberg'%2C%20fontsize%3D14%2C%20weight%3D'bold')%0A%20%20%20%20ax2a.legend(loc%3D'upper%20left'%2C%20fontsize%3D11)%0A%20%20%20%20ax2a.grid(True%2C%20alpha%3D0.3)%0A%20%20%20%20ax2a.set_xlim(1%2C%20200)%0A%20%20%20%20ax2a.set_ylim(0%2C%20200)%0A%0A%20%20%20%20%23%20Mark%20detection%20thresholds%0A%20%20%20%20n_sql_needed%20%3D%20params.sensors_needed_sql%0A%20%20%20%20n_hl_needed%20%3D%20params.sensors_needed_heisenberg%0A%20%20%20%20ax2a.axvline(x%3Dn_sql_needed%2C%20color%3D'b'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.5)%0A%20%20%20%20ax2a.axvline(x%3Dn_hl_needed%2C%20color%3D'r'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.5)%0A%20%20%20%20ax2a.annotate(f'SQL%3A%20N%E2%89%A5%7Bn_sql_needed%7D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(n_sql_needed%2C%20snr_improvement_sql(n_sql_needed))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xytext%3D(n_sql_needed%2B20%2C%20snr_improvement_sql(n_sql_needed)%2B20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D10%2C%20color%3D'blue'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'blue'%2C%20lw%3D1))%0A%20%20%20%20ax2a.annotate(f'HL%3A%20N%E2%89%A5%7Bn_hl_needed%7D'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(n_hl_needed%2C%20snr_improvement_heisenberg(n_hl_needed))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xytext%3D(n_hl_needed%2B20%2C%20snr_improvement_heisenberg(n_hl_needed)%2B10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D10%2C%20color%3D'red'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'red'%2C%20lw%3D1))%0A%0A%20%20%20%20%23%20Right%3A%20Advantage%20factor%20(Heisenberg%20%2F%20SQL)%0A%20%20%20%20advantage%20%3D%20%5Bh%2Fs%20for%20h%2C%20s%20in%20zip(snr_hl%2C%20snr_sql)%5D%0A%20%20%20%20ax2b.plot(n_sensors_range%2C%20advantage%2C%20'g-'%2C%20linewidth%3D2.5)%0A%20%20%20%20ax2b.plot(n_sensors_range%2C%20np.sqrt(n_sensors_range)%2C%20'k--'%2C%20linewidth%3D1.5%2C%20alpha%3D0.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Dr'%24%5Csqrt%7BN%7D%24%20reference')%0A%20%20%20%20ax2b.set_xlabel('Number%20of%20Sensors%20(N)'%2C%20fontsize%3D13)%0A%20%20%20%20ax2b.set_ylabel(r'Quantum%20Advantage%20%3D%20%24N%20%2F%20%5Csqrt%7BN%7D%20%3D%20%5Csqrt%7BN%7D%24'%2C%20fontsize%3D13)%0A%20%20%20%20ax2b.set_title('Quantum%20Advantage%20Factor'%2C%20fontsize%3D14%2C%20weight%3D'bold')%0A%20%20%20%20ax2b.grid(True%2C%20alpha%3D0.3)%0A%20%20%20%20ax2b.legend(fontsize%3D11)%0A%0A%20%20%20%20plt.tight_layout()%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%20Multi-Sensor%20Fusion%20Results%0A%0A%20%20%20%20**Anomaly%20signal**%3A%20%24%5C%5Cphi_%7B%7Banomaly%7D%7D%20%3D%20%7Bparams.anomaly_phase*1000%3A.1f%7D%24%20mrad%20(below%20%7Bparams.threshold_rad*1000%3A.0f%7D%20mrad%20threshold)%0A%0A%20%20%20%20**Signal-to-threshold%20ratio**%3A%20%7Bparams.signal_to_threshold_ratio%3A.1%25%7D%0A%0A%20%20%20%20%23%23%23%20Sensors%20Required%20for%20Detection%0A%0A%20%20%20%20%7C%20Approach%20%7C%20Formula%20%7C%20Sensors%20Needed%20%7C%20With%20N%3D%7Bparams.n_sensors%7D%20%7C%0A%20%20%20%20%7C----------%7C---------%7C----------------%7C--------------------------%7C%0A%20%20%20%20%7C%20**Classical%20(SQL)**%20%7C%20%24N%20%5C%5Cgeq%20(%5C%5Ctheta%2F%5C%5Cphi)%5E2%24%20%7C%20%7Bparams.sensors_needed_sql%7D%20%7C%20%7B'%E2%9C%93%20Detectable'%20if%20params.n_sensors%20%3E%3D%20params.sensors_needed_sql%20else%20'%E2%9C%97%20Not%20enough'%7D%20%7C%0A%20%20%20%20%7C%20**Quantum%20(Heisenberg)**%20%7C%20%24N%20%5C%5Cgeq%20%5C%5Ctheta%2F%5C%5Cphi%24%20%7C%20%7Bparams.sensors_needed_heisenberg%7D%20%7C%20%7B'%E2%9C%93%20Detectable'%20if%20params.n_sensors%20%3E%3D%20params.sensors_needed_heisenberg%20else%20'%E2%9C%97%20Not%20enough'%7D%20%7C%0A%0A%20%20%20%20%23%23%23%20Key%20Insight%0A%0A%20%20%20%20With%20%7Bparams.n_sensors%7D%20sensors%3A%0A%20%20%20%20-%20**Classical%20averaging**%3A%20Effective%20SNR%20%3D%20%7Bparams.signal_to_threshold_ratio%20*%20np.sqrt(params.n_sensors)%3A.1%25%7D%20of%20threshold%20%E2%86%92%20%7B'DETECTED'%20if%20params.signal_to_threshold_ratio%20*%20np.sqrt(params.n_sensors)%20%3E%3D%201%20else%20'NOT%20detected'%7D%0A%20%20%20%20-%20**Quantum%20coherent**%3A%20Effective%20SNR%20%3D%20%7Bparams.signal_to_threshold_ratio%20*%20params.n_sensors%3A.0%25%7D%20of%20threshold%20%E2%86%92%20**DETECTED**%0A%0A%20%20%20%20**Quantum%20advantage**%3A%20Need%20%7Bparams.sensors_needed_sql%7D%2F%7Bparams.sensors_needed_heisenberg%7D%20%3D%20**%7Bparams.sensors_needed_sql%2Fparams.sensors_needed_heisenberg%3A.0f%7D%C3%97%20fewer%20sensors**%20with%20entanglement!%0A%20%20%20%20%22%22%22)%0A%20%20%20%20fig2%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%20Part%204%3A%20MiRP%20ML-Enhanced%20Approach%0A%0A%20%20%20%20%23%23%20Micro-Ring%20Perceptron%20(arXiv%3A2504.16119)%0A%0A%20%20%20%20From%20%5BWu%2C%20Ma%2C%20Vadlamani%2C%20Choi%2C%20Englund%5D(https%3A%2F%2Farxiv.org%2Fabs%2F2504.16119)%3A%0A%0A%20%20%20%20The%20MiRP%20combines%3A%0A%20%20%20%201.%20**Analog%20optical%20preprocessing**%3A%20Micro-ring%20resonator%20encodes%20temporal%20structure%0A%20%20%20%202.%20**Digital%20neural%20network**%3A%20Learns%20optimal%20inference%20from%20reservoir%20output%0A%0A%20%20%20%20%23%23%23%20Key%20Advantages%20for%20Inference%0A%0A%20%20%20%20%7C%20Classical%20%7C%20MiRP%20%7C%0A%20%20%20%20%7C-----------%7C------%7C%0A%20%20%20%20%7C%20Nyquist%20sampling%20required%20%7C%20**Sub-Nyquist**%20(1%2F49th%20demonstrated)%20%7C%0A%20%20%20%20%7C%20Fixed%20matched%20filter%20%7C%20**Learned**%20optimal%20features%20%7C%0A%20%20%20%20%7C%20Limited%20by%20detector%20noise%20%7C%20Circumvents%20via%20optical%20processing%20%7C%0A%0A%20%20%20%20%23%23%23%20MiRP%20Dynamics%0A%0A%20%20%20%20%24%24%5Cfrac%7Bda%7D%7Bdt%7D%20%3D%20%5Cleft(i%5CDelta%20-%20%5Cfrac%7B%5Ckappa%7D%7B2%7D%5Cright)a%20%2B%20i%5Csqrt%7B%5Ckappa_%7Bex%7D%7Ds_%7Bin%7D(t)%24%24%0A%0A%20%20%20%20The%20output%20%24%7Ca(t)%7C%5E2%24%20encodes%20nonlinear%20transformation%20of%20input%20history%2C%20which%20ML%20extracts.%0A%0A%20%20%20%20%23%23%23%20Connection%20to%20Quantum%20Sensing%0A%0A%20%20%20%20MiRP%20provides%20a%20**classical%20ML%20approximation**%20to%20some%20quantum%20advantages%3A%0A%20%20%20%20-%20Temporal%20encoding%20(similar%20to%20quantum%20memory)%0A%20%20%20%20-%20Nonlinear%20feature%20extraction%20(analogous%20to%20QSP%20transformation)%0A%20%20%20%20-%20But%20**no%20coherent%20sensor%20addition**%20(fundamentally%20limited%20to%20SQL)%0A%0A%20%20%20%20**Bottom%20line**%3A%20MiRP%20gives%20~5%20dB%20improvement%3B%20quantum%20gives%2020%2B%20dB%20for%20large%20%24n_S%24.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20np%2C%20params%2C%20plt)%3A%0A%20%20%20%20%23%20Comparison%20plot%3A%20Phase%20accuracy%20across%20all%20three%20approaches%0A%20%20%20%20snr_db_range%20%3D%20np.linspace(10%2C%2060%2C%20100)%0A%0A%20%20%20%20def%20classical_phase_accuracy(snr_db%2C%20N_eff%3D5)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Cram%C3%A9r-Rao%20limited%20phase%20accuracy%20(single%20sensor)%22%22%22%0A%20%20%20%20%20%20%20%20snr_linear%20%3D%2010**(snr_db%20%2F%2010)%0A%20%20%20%20%20%20%20%20return%201%20%2F%20np.sqrt(2%20*%20snr_linear%20*%20N_eff)%0A%0A%20%20%20%20def%20mirp_phase_accuracy(snr_db%2C%20N_eff%3D5%2C%20ml_gain%3D3.0)%3A%0A%20%20%20%20%20%20%20%20%22%22%22MiRP%20with%20~3x%20effective%20SNR%20utilization%22%22%22%0A%20%20%20%20%20%20%20%20effective_snr_db%20%3D%20snr_db%20%2B%2010*np.log10(ml_gain)%0A%20%20%20%20%20%20%20%20snr_linear%20%3D%2010**(effective_snr_db%20%2F%2010)%0A%20%20%20%20%20%20%20%20return%201%20%2F%20np.sqrt(2%20*%20snr_linear%20*%20N_eff)%0A%0A%20%20%20%20def%20quantum_phase_accuracy(snr_db%2C%20N_eff%3D5%2C%20n_sensors%3D100)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Quantum%20coherent%20sensing%3A%20n_S%5E2%20SNR%20improvement%22%22%22%0A%20%20%20%20%20%20%20%20snr_single%20%3D%2010**(snr_db%20%2F%2010)%0A%20%20%20%20%20%20%20%20snr_coherent%20%3D%20n_sensors**2%20*%20snr_single%0A%20%20%20%20%20%20%20%20return%201%20%2F%20np.sqrt(2%20*%20snr_coherent%20*%20N_eff)%0A%0A%20%20%20%20classical_phase%20%3D%20%5Bclassical_phase_accuracy(s)%20for%20s%20in%20snr_db_range%5D%0A%20%20%20%20mirp_phase%20%3D%20%5Bmirp_phase_accuracy(s)%20for%20s%20in%20snr_db_range%5D%0A%20%20%20%20quantum_phase%20%3D%20%5Bquantum_phase_accuracy(s%2C%20n_sensors%3Dparams.n_sensors)%20for%20s%20in%20snr_db_range%5D%0A%0A%20%20%20%20fig3%2C%20ax3%20%3D%20plt.subplots(figsize%3D(12%2C%207))%0A%0A%20%20%20%20ax3.semilogy(snr_db_range%2C%20classical_phase%2C%20'b-'%2C%20linewidth%3D2.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D'Classical%20(single%20sensor)')%0A%20%20%20%20ax3.semilogy(snr_db_range%2C%20mirp_phase%2C%20'orange'%2C%20linewidth%3D2.5%2C%20linestyle%3D'--'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D'MiRP%20(ML-enhanced)')%0A%20%20%20%20ax3.semilogy(snr_db_range%2C%20quantum_phase%2C%20'r-'%2C%20linewidth%3D2.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Quantum%20(n_S%3D%7Bparams.n_sensors%7D%20coherent)')%0A%0A%20%20%20%20ax3.axhline(y%3D1e-3%2C%20color%3D'k'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.7%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D'Target%3A%201%20mrad')%0A%0A%20%20%20%20%23%20Find%20SNR%20needed%20for%201%20mrad%0A%20%20%20%20classical_snr_1mrad%20%3D%20snr_db_range%5Bnp.argmin(np.abs(np.array(classical_phase)%20-%201e-3))%5D%0A%20%20%20%20mirp_snr_1mrad%20%3D%20snr_db_range%5Bnp.argmin(np.abs(np.array(mirp_phase)%20-%201e-3))%5D%0A%20%20%20%20quantum_snr_1mrad%20%3D%20snr_db_range%5Bnp.argmin(np.abs(np.array(quantum_phase)%20-%201e-3))%5D%0A%0A%20%20%20%20ax3.axvline(x%3Dclassical_snr_1mrad%2C%20color%3D'b'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.5)%0A%20%20%20%20ax3.axvline(x%3Dmirp_snr_1mrad%2C%20color%3D'orange'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.5)%0A%20%20%20%20ax3.axvline(x%3Dquantum_snr_1mrad%2C%20color%3D'r'%2C%20linestyle%3D'%3A'%2C%20alpha%3D0.5)%0A%0A%20%20%20%20ax3.annotate(f'Classical%3A%20%7Bclassical_snr_1mrad%3A.0f%7D%20dB'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(classical_snr_1mrad%2C%201e-3)%2C%20xytext%3D(classical_snr_1mrad%2B3%2C%203e-3)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'blue'%2C%20lw%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D11%2C%20color%3D'blue'%2C%20weight%3D'bold')%0A%20%20%20%20ax3.annotate(f'MiRP%3A%20%7Bmirp_snr_1mrad%3A.0f%7D%20dB'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(mirp_snr_1mrad%2C%201e-3)%2C%20xytext%3D(mirp_snr_1mrad%2B3%2C%205e-4)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'orange'%2C%20lw%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D11%2C%20color%3D'orange'%2C%20weight%3D'bold')%0A%20%20%20%20ax3.annotate(f'Quantum%3A%20%7Bquantum_snr_1mrad%3A.0f%7D%20dB'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xy%3D(quantum_snr_1mrad%2C%201e-3)%2C%20xytext%3D(quantum_snr_1mrad-12%2C%203e-3)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20arrowprops%3Ddict(arrowstyle%3D'-%3E'%2C%20color%3D'red'%2C%20lw%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fontsize%3D11%2C%20color%3D'red'%2C%20weight%3D'bold')%0A%0A%20%20%20%20ax3.set_xlabel('Input%20SNR%20per%20sensor%20(dB)'%2C%20fontsize%3D13)%0A%20%20%20%20ax3.set_ylabel(r'Phase%20Accuracy%20%24%5Csigma_%5Cphi%24%20(rad)'%2C%20fontsize%3D13)%0A%20%20%20%20ax3.set_title('Phase%20Estimation%3A%20Classical%20vs%20ML%20vs%20Quantum'%2C%20fontsize%3D15%2C%20weight%3D'bold')%0A%20%20%20%20ax3.set_xlim(10%2C%2060)%0A%20%20%20%20ax3.set_ylim(1e-8%2C%201e-1)%0A%20%20%20%20ax3.legend(loc%3D'upper%20right'%2C%20fontsize%3D11)%0A%20%20%20%20ax3.grid(True%2C%20alpha%3D0.3)%0A%0A%20%20%20%20plt.tight_layout()%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%20Phase%20Accuracy%20Comparison%0A%0A%20%20%20%20For%201%20mrad%20phase%20accuracy%20(%24%5C%5Csigma_%5C%5Cphi%20%3C%2010%5E%7B%7B-3%7D%7D%24%20rad)%3A%0A%0A%20%20%20%20%7C%20Approach%20%7C%20Required%20SNR%20%7C%20Advantage%20%7C%0A%20%20%20%20%7C----------%7C--------------%7C-----------%7C%0A%20%20%20%20%7C%20Classical%20%7C%20%7Bclassical_snr_1mrad%3A.0f%7D%20dB%20%7C%20(baseline)%20%7C%0A%20%20%20%20%7C%20MiRP%20%7C%20%7Bmirp_snr_1mrad%3A.0f%7D%20dB%20%7C%20%7Bclassical_snr_1mrad%20-%20mirp_snr_1mrad%3A.0f%7D%20dB%20savings%20%7C%0A%20%20%20%20%7C%20Quantum%20%7C%20%7Bquantum_snr_1mrad%3A.0f%7D%20dB%20%7C%20**%7Bclassical_snr_1mrad%20-%20quantum_snr_1mrad%3A.0f%7D%20dB%20savings**%20%7C%0A%0A%20%20%20%20The%20quantum%20advantage%20of%20**%7Bclassical_snr_1mrad%20-%20quantum_snr_1mrad%3A.0f%7D%20dB**%20translates%20to%3A%0A%20%20%20%20-%20**%7B10**((classical_snr_1mrad%20-%20quantum_snr_1mrad)%2F10)%3A.0f%7D%C3%97**%20lower%20input%20power%2C%20OR%0A%20%20%20%20-%20**%7B10**((classical_snr_1mrad%20-%20quantum_snr_1mrad)%2F20)%3A.0f%7D%C3%97**%20better%20sensitivity%20at%20same%20power%0A%20%20%20%20%22%22%22)%0A%20%20%20%20fig3%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20np%2C%20params)%3A%0A%20%20%20%20mo.md(rf%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%20Part%205%3A%20Summary%20-%20Power%20Grid%20Distributed%20Perceptron%20Inference%0A%0A%20%20%20%20%23%23%20Key%20Insight%3A%20Sub-Threshold%20Anomaly%20Detection%0A%0A%20%20%20%20**Power%20grid%20magnetometry%20is%20NOT%20sensitivity-limited%3A**%0A%20%20%20%20-%20Typical%20field%3A%201-10%20%C2%B5T%20(under%20transmission%20lines)%0A%20%20%20%20-%20NV%20sensitivity%3A%20~1%20pT%2F%E2%88%9AHz%0A%20%20%20%20-%20SNR%3A%20~%7Bparams.snr_db%3A.0f%7D%20dB%20(excellent!)%0A%0A%20%20%20%20**This%20is%20NOT%20a%20frequency%20search%20problem**%20-%20we%20KNOW%20it's%2060%20Hz!%0A%0A%20%20%20%20**The%20real%20challenge**%3A%20Detect%20weak%20anomalies%20**below%20threshold%20at%20individual%20sensors**.%0A%0A%20%20%20%20%23%23%23%20The%20Distributed%20Perceptron%20Model%0A%0A%20%20%20%20%7C%20Component%20%7C%20Description%20%7C%0A%20%20%20%20%7C-----------%7C-------------%7C%0A%20%20%20%20%7C%20**Sensors**%20%7C%20N%20%3D%20%7Bparams.n_sensors%7D%20NV%20magnetometers%20across%20grid%20%7C%0A%20%20%20%20%7C%20**Local%20perceptron**%20%7C%20Fires%20if%20%24%7C%5Cphi%7C%20%3E%20%7Bparams.threshold_rad*1000%3A.0f%7D%24%20mrad%20over%20%7Bparams.integration_cycles%7D%20cycles%20%7C%0A%20%20%20%20%7C%20**Global%20inference**%20%7C%20Aggregate%20firings%20to%20detect%20anomalies%20%7C%0A%20%20%20%20%7C%20**Anomaly%20signal**%20%7C%20%7Bparams.anomaly_phase*1000%3A.1f%7D%20mrad%20(below%20threshold!)%20%7C%0A%0A%20%20%20%20%23%23%23%20Three%20Approaches%20Compared%0A%0A%20%20%20%20%7C%20Approach%20%7C%20SNR%20Boost%20%7C%20Detection%20%7C%20Hardware%20%7C%0A%20%20%20%20%7C----------%7C-----------%7C-----------%7C----------%7C%0A%20%20%20%20%7C%20**Classical%20(voting)**%20%7C%201%C3%97%20%7C%20Only%20above-threshold%20%7C%20Simple%20%7C%0A%20%20%20%20%7C%20**Classical%20(averaging)**%20%7C%20%24%5Csqrt%7B%7BN%7D%7D%20%3D%20%7Bnp.sqrt(params.n_sensors)%3A.0f%7D%5C%5Ctimes%24%20%7C%20Marginal%20sub-threshold%20%7C%20Simple%20%7C%0A%20%20%20%20%7C%20**Quantum%20(entangled)**%20%7C%20%24N%20%3D%20%7Bparams.n_sensors%7D%5C%5Ctimes%24%20%7C%20**Full%20sub-threshold**%20%7C%20Complex%20%7C%0A%0A%20%20%20%20%23%23%23%20Key%20Equations%0A%0A%20%20%20%20**SQL%20(Classical%20averaging)**%3A%0A%20%20%20%20%24%24%5Ctext%7B%7BSNR%7D%7D_%7B%7BSQL%7D%7D%20%3D%20%5Csqrt%7B%7BN%7D%7D%20%5Ctimes%20%5Ctext%7B%7BSNR%7D%7D_%7B%7Bsingle%7D%7D%24%24%0A%0A%20%20%20%20**Heisenberg%20Limit%20(Entangled)**%3A%0A%20%20%20%20%24%24%5Ctext%7B%7BSNR%7D%7D_%7B%7BHL%7D%7D%20%3D%20N%20%5Ctimes%20%5Ctext%7B%7BSNR%7D%7D_%7B%7Bsingle%7D%7D%24%24%0A%0A%20%20%20%20**Sensors%20needed%20for%20detection**%3A%0A%20%20%20%20-%20SQL%3A%20%24N%20%5Cgeq%20(%5Ctheta%2F%5Cphi)%5E2%20%3D%20%7Bparams.sensors_needed_sql%7D%24%0A%20%20%20%20-%20Heisenberg%3A%20%24N%20%5Cgeq%20%5Ctheta%2F%5Cphi%20%3D%20%7Bparams.sensors_needed_heisenberg%7D%24%0A%0A%20%20%20%20%23%23%23%20When%20Does%20Quantum%20Help%3F%0A%0A%20%20%20%20%7C%20Scenario%20%7C%20SQL%20Detection%20%7C%20Heisenberg%20Detection%20%7C%20Quantum%20Advantage%20%7C%0A%20%20%20%20%7C----------%7C---------------%7C---------------------%7C-------------------%7C%0A%20%20%20%20%7C%20**Above%20threshold**%20(%CF%86%20%3E%20%CE%B8)%20%7C%20%E2%9C%93%20Any%20N%20%7C%20%E2%9C%93%20Any%20N%20%7C%20None%20%7C%0A%20%20%20%20%7C%20**Near%20threshold**%20(%CF%86%20~%200.5%CE%B8)%20%7C%20Need%20N%20%E2%89%A5%204%20%7C%20Need%20N%20%E2%89%A5%202%20%7C%20**2%C3%97%20fewer%20sensors**%20%7C%0A%20%20%20%20%7C%20**Sub-threshold**%20(%CF%86%20~%200.1%CE%B8)%20%7C%20Need%20N%20%E2%89%A5%20100%20%7C%20Need%20N%20%E2%89%A5%2010%20%7C%20**10%C3%97%20fewer%20sensors**%20%7C%0A%0A%20%20%20%20%3E%20**Bottom%20line**%3A%20For%20distributed%20sensor%20networks%20detecting%20**sub-threshold%20anomalies**%2C%0A%20%20%20%20%3E%20quantum%20entanglement%20provides%20**%E2%88%9AN%20fewer%20sensors**%20for%20the%20same%20detection%20capability.%0A%20%20%20%20%3E%20With%20N%20%3D%20100%20sensors%2C%20this%20means%20**10%C3%97%20resource%20reduction**%20or%20**10%C3%97%20better%20sensitivity**!%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%20References%0A%0A%20%20%20%201.%20**QSS%20Paper**%3A%20%22Quantum%20Computing%20Enhanced%20Sensing%22%20%5BarXiv%3A2501.07625v1%5D(https%3A%2F%2Farxiv.org%2Fabs%2F2501.07625)%0A%20%20%20%202.%20**MiRP%20Paper**%3A%20Wu%2C%20Ma%2C%20Vadlamani%2C%20Choi%2C%20Englund.%20%22Micro-Ring%20Perceptron%20Sensor%22%20%5BarXiv%3A2504.16119%5D(https%3A%2F%2Farxiv.org%2Fabs%2F2504.16119)%0A%20%20%20%203.%20**Power%20Grid%20EMF**%3A%20Typical%2040%20mG%20under%20500%20kV%20transmission%20lines%0A%20%20%20%204.%20**Heisenberg%20Limit**%3A%20Giovannetti%20et%20al.%2C%20%22Quantum%20Metrology%22%20(2011)%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20np%2C%20params)%3A%0A%20%20%20%20%23%20Calculate%20key%20quantities%20for%20summary%0A%20%20%20%20T_integration%20%3D%20params.integration_cycles%20%2F%20params.f_signal%0A%20%20%20%20signal_ratio%20%3D%20params.anomaly_phase%20%2F%20params.threshold_rad%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%20Appendix%3A%20Distributed%20Perceptron%20Inference%20Summary%0A%0A%20%20%20%20%23%23%20System%20Configuration%0A%0A%20%20%20%20%7C%20Parameter%20%7C%20Value%20%7C%20Description%20%7C%0A%20%20%20%20%7C-----------%7C-------%7C-------------%7C%0A%20%20%20%20%7C%20%24f_0%24%20%7C%20%7Bparams.f_signal%7D%20Hz%20%7C%20Power%20grid%20fundamental%20(KNOWN!)%20%7C%0A%20%20%20%20%7C%20%24B_%7B%7Btypical%7D%7D%24%20%7C%20%7Bparams.B_typical*1e6%3A.0f%7D%20%C2%B5T%20%7C%20Typical%20field%20under%20transmission%20line%20%7C%0A%20%20%20%20%7C%20%24B_%7B%7Bmin%7D%7D%24%20%7C%20%7Bparams.B_min*1e12%3A.0f%7D%20pT%20%7C%20NV%20sensitivity%20floor%20%7C%0A%20%20%20%20%7C%20**SNR**%20%7C%20**%7Bparams.snr_db%3A.0f%7D%20dB**%20%7C%20HIGH!%20Sensitivity%20is%20NOT%20the%20issue%20%7C%0A%20%20%20%20%7C%20%24%5C%5Ctheta%24%20%7C%20%7Bparams.threshold_rad*1000%3A.1f%7D%20mrad%20%7C%20Perceptron%20firing%20threshold%20%7C%0A%20%20%20%20%7C%20%24M%24%20%7C%20%7Bparams.integration_cycles%7D%20cycles%20%7C%20Integration%20window%20(%7BT_integration*1000%3A.0f%7D%20ms)%20%7C%0A%20%20%20%20%7C%20%24N%24%20%7C%20%7Bparams.n_sensors%7D%20%7C%20Distributed%20sensors%20%7C%0A%0A%20%20%20%20%23%23%20Sub-Threshold%20Detection%20Challenge%0A%0A%20%20%20%20%7C%20Scenario%20%7C%20Signal%2FThreshold%20%7C%20Detection%20%7C%0A%20%20%20%20%7C----------%7C-----------------%7C-----------%7C%0A%20%20%20%20%7C%20**Single%20sensor**%20%7C%20%7Bsignal_ratio%3A.1%25%7D%20%7C%20**NOT%20detected**%20(below%20threshold)%20%7C%0A%20%20%20%20%7C%20**Classical%20averaging%20(%24%5C%5Csqrt%7B%7BN%7D%7D%24)**%20%7C%20%7Bsignal_ratio%20*%20np.sqrt(params.n_sensors)%3A.0%25%7D%20%7C%20%7B'Detected%20%E2%9C%93'%20if%20signal_ratio%20*%20np.sqrt(params.n_sensors)%20%3E%201%20else%20'NOT%20detected%20%E2%9C%97'%7D%20%7C%0A%20%20%20%20%7C%20**Quantum%20coherent%20(%24N%24)**%20%7C%20%7Bsignal_ratio%20*%20params.n_sensors%3A.0%25%7D%20%7C%20**Detected%20%E2%9C%93**%20(with%20entanglement)%20%7C%0A%0A%20%20%20%20%23%23%20Sensors%20Required%20for%20Detection%0A%0A%20%20%20%20%7C%20Approach%20%7C%20Sensors%20Needed%20%7C%20With%20N%3D%7Bparams.n_sensors%7D%20%7C%0A%20%20%20%20%7C----------%7C----------------%7C--------------------------%7C%0A%20%20%20%20%7C%20Classical%20averaging%20(SQL)%20%7C%20%24N%20%5C%5Cgeq%20(%5C%5Ctheta%2F%5C%5Cphi)%5E2%20%3D%20%7Bparams.sensors_needed_sql%7D%24%20%7C%20%7B'%E2%9C%93%20Sufficient'%20if%20params.n_sensors%20%3E%3D%20params.sensors_needed_sql%20else%20'%E2%9C%97%20Need%20more'%7D%20%7C%0A%20%20%20%20%7C%20Quantum%20coherent%20(HL)%20%7C%20%24N%20%5C%5Cgeq%20%5C%5Ctheta%2F%5C%5Cphi%20%3D%20%7Bparams.sensors_needed_heisenberg%7D%24%20%7C%20%7B'%E2%9C%93%20Sufficient'%20if%20params.n_sensors%20%3E%3D%20params.sensors_needed_heisenberg%20else%20'%E2%9C%97%20Need%20more'%7D%20%7C%0A%0A%20%20%20%20%23%23%20Key%20Message%20for%20Power%20Grid%20Monitoring%0A%0A%20%20%20%20%3E%20**We%20KNOW%20the%20frequency%20is%2060%20Hz.**%20This%20is%20NOT%20a%20search%20problem!%0A%20%20%20%20%3E%0A%20%20%20%20%3E%20**The%20challenge%20is%20sub-threshold%20signal%20detection**%20across%20%7Bparams.n_sensors%7D%20distributed%20sensors.%0A%20%20%20%20%3E%0A%20%20%20%20%3E%20**Quantum%20advantage**%3A%20Coherent%20multi-sensor%20fusion%20provides%20**Heisenberg%20scaling**%3A%0A%20%20%20%20%3E%20-%20SQL%20(classical%20averaging)%3A%20SNR%20~%20%24%5C%5Csqrt%7B%7BN%7D%7D%20%3D%20%7Bnp.sqrt(params.n_sensors)%3A.0f%7D%5C%5Ctimes%24%20improvement%0A%20%20%20%20%3E%20-%20Heisenberg%20(entangled)%3A%20SNR%20~%20%24N%20%3D%20%7Bparams.n_sensors%7D%5C%5Ctimes%24%20improvement%0A%20%20%20%20%3E%0A%20%20%20%20%3E%20For%20**weak%20anomaly%20detection**%20(sub-threshold%20at%20individual%20sensors)%3A%0A%20%20%20%20%3E%20-%20Quantum%20coherent%20readout%20enables%20detection%20of%20signals%20that%20classical%20averaging%20**cannot%20see**%0A%20%20%20%20%3E%20-%20Requires%20**entanglement**%20between%20sensors%20for%20true%20Heisenberg%20scaling%0A%20%20%20%20%3E%20-%20MiRP-style%20ML%20provides%20intermediate%20gains%20via%20learned%20feature%20extraction%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notebook.py",
            "mode": "read",
            "version": "0.19.8",
            "serverToken": "unused",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "full"},
            "view": {"showAppCode": false},
            "notebook": null,
            "session": null,
            "runtimeConfig": null,
        };
    </script>
  </body>
</html>
